<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="r.png">
    <title>Mural Rubix</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
</head>

<body>
    <div class="container">
        <div style="text-align: center;">
            <img src="isepe.png" class="imagem-centralizada" alt="Logo ISEPE">
        </div>
        <header class="header">
            <div class="user-info-header">
                <h2>Ol√°, <span id="nomeUsuario">Carregando...</span>!</h2>
                <p id="rubixcoins-display"><i class="fas fa-coins"></i> RubixCoins: <span id="saldoRubixCoins">0</span>
                </p>
                <div style="text-align: center;">
                    <h3>Bem-vindo √† nossa Rede Social!<br>
                        Este projeto foi desenvolvido como parte de um trabalho acad√™mico<br>
                        com o objetivo de criar um espa√ßo interativo onde usu√°rios podem compartilhar ideias,<br>
                        postar mensagens, comentar e se conectar com outras pessoas. Estamos sempre evoluindo e abertos
                        a sugest√µes.<br>
                        Aproveite e explore a plataforma!<br></h3>
                    <h5>Acumule moedas postando, comentando, jogando e at√©<br>
                        mesmo trocando a foto de perfil</h5><br>
                    <a href="ranking.html" class="btn">üèÜ Ver Ranking Completo</a>
                    <nav class="nav-buttons">
                        <div>
                            <br>
                        </div>
                        <div>
                            <button onclick="irParaPerfil()">Ver Perfil</button>
                            <button onclick="game()">Game</button>
                            <button onclick="sair()">Sair</button>
                        </div>
                        <div>
                            <br>
                            <br>
                        </div>
                    </nav>
                </div>
            </div>
            <div class="content-wrapper">
                <main class="main-content">
                    <div class="new-post-section">
                        <div class="profile-and-input">
                            <img id="fotoPerfilHeader" class="foto-perfil-header" src="" alt="Foto de Perfil">
                            <div class="post-input-area">
                                <textarea id="mensagem" placeholder="O que est√° acontecendo?"></textarea>

                                <div id="image-preview-container"
                                    style="display: none; margin-top: 10px; position: relative;">
                                    <img id="image-preview" src="#" alt="Preview da imagem"
                                        style="max-width: 100%; border-radius: 8px;">
                                    <button id="remove-image-btn"
                                        style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.7); border: none; color: white; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; display: flex; align-items: center; justify-content: center;">X</button>
                                </div>
                            </div>
                        </div>
                        <script>

                            document.addEventListener("DOMContentLoaded", function () {
                                const fotoPerfil = localStorage.getItem("fotoPerfilUrl");
                                const fotoPerfilHeader = document.getElementById("fotoPerfilHeader");

                                // Se houver uma foto salva no localStorage, exibe ela
                                if (fotoPerfil && fotoPerfilHeader) {
                                    fotoPerfilHeader.src = fotoPerfil;
                                } else {
                                    fotoPerfilHeader.src = "default-profile.png"; // imagem padr√£o
                                }
                            });

                            async function postarMensagem() {
                                const texto = document.getElementById("mensagem").value.trim();
                                if (texto === "") {
                                    alert("Voc√™ precisa escrever algo.");
                                    return;
                                }

                                const fotoPerfil = localStorage.getItem("fotoPerfilUrl") || "default-profile.png"; // Foto de perfil ou imagem padr√£o

                                // Buscar o nome do usu√°rio no localStorage
                                const currentUser = JSON.parse(localStorage.getItem("perfil")) || {};
                                const nomeUsuario = currentUser.username || "Usu√°rio";

                                // Cria√ß√£o do novo post
                                const post = document.createElement("div");
                                post.classList.add("post");

                                post.innerHTML = `
        <div class="post-header">
            <img src="${fotoPerfil}" alt="Foto de Perfil" class="foto-perfil-post">
            <span>${nomeUsuario}</span> <!-- Exibe o nome do usu√°rio -->
        </div>
        <p>${texto}</p>
    `;

                                const mural = document.getElementById("mural");
                                mural.appendChild(post);

                                document.getElementById("mensagem").value = "";
                            }
                        </script>

                        <div>
                        </div>
                        <div class="post-actions-toolbar">
                            <input type="file" id="file-upload" accept="image/*" style="display: none;">
                            <label for="file-upload" class="action-button-icon" title="Adicionar imagem">
                                <i class="fas fa-image"></i>
                            </label>
                            <button id="emoji-btn-main" class="emoji-button" title="Adicionar emoji">üòÄ</button>
                            <button onclick="postarMensagem()" class="rubitar-btn">Rubitar</button>
                        </div>
                        <div>
                            <br>
                            <br>
                        </div>
                    </div>
                    <ul id="rankingListTop3">
                    </ul>
            </div>
            <div>
                <br>
                <br>
            </div>
            <div id="mural" class="feed-posts"></div>
            </main>
    </div>
    </div>
    <div id="coin-animation-container"></div>
    <emoji-picker style="display: none; position: absolute; z-index: 1000;"></emoji-picker>

    <script>
        async function carregarMensagens() {
            const mural = document.getElementById("mural");
            mural.innerHTML = "<p>Carregando mural...</p>";

            mural.innerHTML = "<p>Mensagens carregadas sem o uso do Supabase.</p>";
        }

        function sair() {
            window.location.href = "index.html";
        }

        function irParaPerfil() {
            window.location.href = "perfil.html";
        }

        function game() {
            window.location.href = "pggame.html";
        }
    </script>
</body>

</html>
<script src="script.js"></script>